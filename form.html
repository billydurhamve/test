<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Employee Purchase Form</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="form-container">
  <h1>Employee Purchase Form</h1>
  <form id="purchaseForm">
    <input type="text" name="name" id="name" placeholder="Full Name" required>
    <input type="email" name="email" id="email" placeholder="Email" required>
    <input type="text" name="department" id="department" placeholder="Department" required>
    <input type="text" name="vendor" placeholder="Vendor" required>
    <input type="text" name="product" placeholder="Product / Service" required>
    <input type="number" name="amount" placeholder="Amount" step="0.01" required>
    <input type="date" name="date" required>
    <select name="payment" required>
      <option value="">Payment Type</option>
      <option>VE Bank Debit Card</option>
      <option>Trade / Exchange</option>
      <option>Purchase Order</option>
      <option>Other</option>
    </select>
    <input type="url" name="file" placeholder="Proof of Purchase URL">
    <textarea name="notes" placeholder="Notes"></textarea>
    <button type="submit">Submit</button>
  </form>
</div>

<script src="script.js"></script>
<script>
const userData = JSON.parse(sessionStorage.getItem('user'));
if(!userData) window.location.href = 'index.html';
document.getElementById('name').value = userData.name;
document.getElementById('email').value = userData.email;
document.getElementById('department').value = userData.department;

document.getElementById('purchaseForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData.entries());

  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwtMxTjHv8vDNfZeeoDl92i2lFeEivlvmZwIjkuxUBylhjIzInYN6gyXqS2qwAQ9aCLCQ/exec";

  try {
    await fetch(WEB_APP_URL, {
      method: 'POST',
      mode: 'no-cors',
      body: JSON.stringify(data),
      headers: {'Content-Type': 'application/json'}
    });
    alert('Form submitted successfully!');
    e.target.reset();
  } catch (err) {
    alert('Error submitting form.');
    console.error(err);
  }
});
</script>

</body>
</html>
